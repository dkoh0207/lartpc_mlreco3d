iotool: 
  batch_size: 16
  collate_fn: 
    CollateSparse
  dataset: 
    data_keys:
      - /gpfs/slac/staas/fs1/g/neutrino/kterao/data/dlprod_ppn_v10/shower_relabel/combined/train_512px.root
    limit_num_files: 10
    name: LArCVDataset
    schema:
      cluster_label:
          - parse_cluster3d_scales
          - cluster3d_mcst
          - sparse3d_fivetypes
      input_data:
          - parse_sparse3d_scn
          - sparse3d_data
      segment_label:
          - parse_sparse3d_scn_scales
          - sparse3d_fivetypes
  num_workers: 4
  sampler:
    batch_size: 16
    name: RandomSequenceSampler
  shuffle: False
model: 
  name: clusternet_density
  modules:
    clustering_loss:
      intra_weight: 1.0
      inter_weight: 1.0
      intercluster_margin: 1.5
      intracluster_margin: 0.5
      reg_weight: 0.001
      seg_weight: 0.0
      density_weight: 0.0
      density_estimate: True
      density_estimate_weight: 0.0
      clustering_weight: 0.0
      real_distance_weight: 0.01
      spatial_size: 512
      use_gpu: True
    clusternet_density:
      N: 3
      data_dim: 3
      filters: 16
      num_classes: 5
      num_strides: 5
      spatial_size: 512
      use_gpu: True
      cluster_add_coords: True
      density_estimate: True
      hypDim: 16
  network_input:
    - input_data
  loss_input:
    - segment_label
    - cluster_label
trainval:
  seed: 123
  learning_rate: 0.001
  gpus: '1'
  weight_prefix: /gpfs/slac/staas/fs1/g/neutrino/koh0207/weights_clustering/density/real_distance_only/snapshot
  iterations: 3000
  report_step: 1
  checkpoint_step: 100
  log_dir: log_clustering/density/real_distance_only
  model_path: ''
  train: True
  debug: False
  minibatch_size: -1